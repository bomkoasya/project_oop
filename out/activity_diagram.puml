@startuml
skinparam conditionStyle inside

|Користувач|
start
:Вводить дані транзакції\n(сума, категорія, дата);

|GUI (Інтерфейс)|
:Перевірка полів форми;
if (Дані заповнені коректно?) then (Ні)
  :Показати повідомлення\nпро помилку вводу;
  stop
else (Так)
  |Core (Бізнес-логіка)|
  :Створити об'єкт Transaction;
  
  if (Це витрата (amount < 0)?) then (Так)
    :Отримати Budget для цієї категорії;
    :Викликати Budget::applyBudgetRules();
    
    if (Ліміт бюджету перевищено?) then (Так)
      |GUI (Інтерфейс)|
      :Показати попередження (Warning);
      |Користувач|
      if (Продовжити все одно?) then (Ні)
        stop
      else (Так)
      endif
    else (Ні)
    endif
  else (Ні, це дохід)
  endif

  |Core (Бізнес-логіка)|
  :Зберегти транзакцію (Database::save);
  :Оновити баланс Account;
  
  |GUI (Інтерфейс)|
  :Оновити таблицю на екрані;
  :Показати повідомлення про успіх;
endif

|Користувач|
:Переглядає оновлений баланс;
stop
@enduml